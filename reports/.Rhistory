p1
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme(axis.text.x=element_text(angle=60, hjust=1))
+ theme_bw()
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme(axis.text.x=element_text(angle=60, hjust=1)) + theme_bw()
p1
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme(axis.text.x=element_text(angle=60, hjust=1))
p1
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme(axis.text.x = element_text(angle = 90))
p1 =p1+ theme_bw()
p1
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme(axis.text.x = element_text(angle = 90))
p1
print(paste('State name: ', s, sep = ''))
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90))
p1
ggsave(paste(s, 'tw_counts.jpeg', sep='_'), p1, width = 10, height = 8, dpi = 300)
## anger
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_anger)] * 1.2
p2 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_anger * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Anger (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90))
p2
ggsave(paste(s, 'anger.jpeg', sep='_'), p2, width = 10, height = 8, dpi = 300)
## sadness
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_sadness)] * 1.2
p3 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_sadness * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Sadness (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90))
p3
ggsave(paste(s, 'sadness.jpeg', sep='_'), p3, width = 10, height = 8, dpi = 300)
## joy
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_joy)]  * 1.2
p4 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_joy * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Joy (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90))
p4
ggsave(paste(s, 'joy.jpeg', sep='_'), p4, width = 10, height = 8, dpi = 300)
## disgust
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_disgust)]  * 1.2
p5 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_disgust * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Disgust (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90))
p5
ggsave(paste(s, 'disgust.jpeg', sep='_'), p5, width = 10, height = 8, dpi = 300)
## fear
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_fear)]  * 1.2
p6 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_fear * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Fear (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90))
p6
ggsave(paste(s, 'fear.jpeg', sep='_'), p6, width = 10, height = 8, dpi = 300)
## surprise
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_surprise)]  * 1.2
p7 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_surprise * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Surprise (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90))
p7
ggsave(paste(s, 'surprise.jpeg', sep='_'), p7, width = 10, height = 8, dpi = 300)
plot_grid(p2,p3,p4,p5,p6,p7, labels=c('anger','sadness', 'joy','disgust','fear','surprise'), ncol = 3, nrow = 2)
p = plot_grid(p2,p3,p4,p5,p6,p7, labels=c('anger','sadness', 'joy','disgust','fear','surprise'), ncol = 3, nrow = 2)
p
s
s
p2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90))
p1
p1
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90))
p1
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90)) + scale_x_continuous(breaks=seq(1, 32, 62, 93,123, 153))
p1
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90)) + scale_x_continuous(breaks=c(1, 32, 62, 93,123, 153))
p1
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90)) + scale_x_discrete(breaks =c(1, 32, 62, 93,123, 153))
p1
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw()  + theme(axis.text.x = element_text(angle = 90)) + scale_x_discrete(breaks =c('2020-05-01', '2020-06-01'))
p1
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
print(paste('State name: ', s, sep = ''))
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
ggsave(paste(s, 'tw_counts.jpeg', sep='_'), p1, width = 10, height = 8, dpi = 300)
## anger
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_anger)] * 1.2
p2 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_anger * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Anger (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p2
ggsave(paste(s, 'anger.jpeg', sep='_'), p2, width = 10, height = 8, dpi = 300)
## sadness
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_sadness)] * 1.2
p3 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_sadness * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Sadness (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p3
ggsave(paste(s, 'sadness.jpeg', sep='_'), p3, width = 10, height = 8, dpi = 300)
## joy
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_joy)]  * 1.2
p4 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_joy * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Joy (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p4
ggsave(paste(s, 'joy.jpeg', sep='_'), p4, width = 10, height = 8, dpi = 300)
## disgust
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_disgust)]  * 1.2
p5 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_disgust * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Disgust (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p5
ggsave(paste(s, 'disgust.jpeg', sep='_'), p5, width = 10, height = 8, dpi = 300)
## fear
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_fear)]  * 1.2
p6 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_fear * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Fear (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p6
ggsave(paste(s, 'fear.jpeg', sep='_'), p6, width = 10, height = 8, dpi = 300)
## surprise
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_surprise)]  * 1.2
p7 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_surprise * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Surprise (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p7
ggsave(paste(s, 'surprise.jpeg', sep='_'), p7, width = 10, height = 8, dpi = 300)
p = plot_grid(p2,p3,p4,p5,p6,p7, labels=c('anger','sadness', 'joy','disgust','fear','surprise'), ncol = 3, nrow = 2)
p
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +  ylim(0, 100000)
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +  ylim(0, 100000) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_anger)] * 1.2
p2 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_anger * tmp_scale), size = 1.5, color="darkblue", group = 1)+  ylim(0, 100000) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Anger (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p2
print(paste('State name: ', s, sep = ''))
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +  ylim(0, 60000) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
ggsave(paste(s, 'tw_counts.jpeg', sep='_'), p1, width = 10, height = 8, dpi = 300)
## anger
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_anger)] * 1.2
p2 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_anger * tmp_scale), size = 1.5, color="darkblue", group = 1)+  ylim(0, 60000) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Anger (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p2
ggsave(paste(s, 'anger.jpeg', sep='_'), p2, width = 10, height = 8, dpi = 300)
## sadness
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_sadness)] * 1.2
p3 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_sadness * tmp_scale), size = 1.5, color="darkblue", group = 1)+  ylim(0, 60000) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Sadness (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p3
ggsave(paste(s, 'sadness.jpeg', sep='_'), p3, width = 10, height = 8, dpi = 300)
## joy
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_joy)]  * 1.2
p4 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_joy * tmp_scale), size = 1.5, color="darkblue", group = 1)+  ylim(0, 60000) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Joy (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p4
ggsave(paste(s, 'joy.jpeg', sep='_'), p4, width = 10, height = 8, dpi = 300)
## disgust
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_disgust)]  * 1.2
p5 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_disgust * tmp_scale), size = 1.5, color="darkblue", group = 1)+  ylim(0, 60000) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Disgust (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p5
ggsave(paste(s, 'disgust.jpeg', sep='_'), p5, width = 10, height = 8, dpi = 300)
## fear
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_fear)]  * 1.2
p6 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_fear * tmp_scale), size = 1.5, color="darkblue", group = 1)+  ylim(0, 60000) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Fear (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p6
ggsave(paste(s, 'fear.jpeg', sep='_'), p6, width = 10, height = 8, dpi = 300)
## surprise
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_surprise)]  * 1.2
p7 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_surprise * tmp_scale), size = 1.5, color="darkblue", group = 1)+  ylim(0, 60000) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Surprise (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p7
ggsave(paste(s, 'surprise.jpeg', sep='_'), p7, width = 10, height = 8, dpi = 300)
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1)
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +  ylim(0, 60000) +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +  ylim(0, 60000) +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_fear)]  * 1.2
p6 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_fear * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Fear (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p6
print(paste('State name: ', s, sep = ''))
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
ggsave(paste(s, 'tw_counts.jpeg', sep='_'), p1, width = 10, height = 8, dpi = 300)
## anger
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_anger)] * 1.2
p2 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_anger * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Anger (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p2
ggsave(paste(s, 'anger.jpeg', sep='_'), p2, width = 10, height = 8, dpi = 300)
## sadness
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_sadness)] * 1.2
p3 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_sadness * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Sadness (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p3
ggsave(paste(s, 'sadness.jpeg', sep='_'), p3, width = 10, height = 8, dpi = 300)
## joy
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_joy)]  * 1.2
p4 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_joy * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Joy (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p4
ggsave(paste(s, 'joy.jpeg', sep='_'), p4, width = 10, height = 8, dpi = 300)
## disgust
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_disgust)]  * 1.2
p5 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_disgust * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Disgust (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p5
ggsave(paste(s, 'disgust.jpeg', sep='_'), p5, width = 10, height = 8, dpi = 300)
## fear
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_fear)]  * 1.2
p6 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_fear * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Fear (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p6
ggsave(paste(s, 'fear.jpeg', sep='_'), p6, width = 10, height = 8, dpi = 300)
## surprise
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_surprise)]  * 1.2
p7 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_surprise * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Surprise (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p7
ggsave(paste(s, 'surprise.jpeg', sep='_'), p7, width = 10, height = 8, dpi = 300)
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(limits=c(0,60000), sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(limits=c(0,100000), sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(limits=c(0,120000), sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
print(paste('State name: ', s, sep = ''))
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(limits=c(0,115000), sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
ggsave(paste(s, 'tw_counts.jpeg', sep='_'), p1, width = 10, height = 8, dpi = 300)
dt
dt[, unique(date)]
dt[, .N, by = date]
View(dt[, .N, by = date])
dt[date=='2020-06-02']
dt[date=='2020-06-01']
dt[date=='2020-06-02']
dt[state=='US total', list(count), by = dt]
names(dt)
dt[state=='US total', list(count), by = date]
View(dt[state=='US total', list(count), by = date])
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_joy)]  * 1.2
p4 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_joy * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,100000), sec.axis = sec_axis(~./tmp_scale, name = "Joy (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p4
print(paste('State name: ', s, sep = ''))
## count
tmp_scale = dt[state==s, mean(new_cases)/mean(count)]* 1.2
p1 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = count * tmp_scale), size = 1.5, color="darkblue", group = 1) +
scale_y_continuous(limits=c(0,115000), sec.axis = sec_axis(~./tmp_scale, name = "Counts of WFH related Tweets"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p1
ggsave(paste(s, 'tw_counts.jpeg', sep='_'), p1, width = 10, height = 8, dpi = 300)
## anger
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_anger)] * 1.2
p2 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_anger * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,75000), sec.axis = sec_axis(~./tmp_scale, name = "Anger (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p2
ggsave(paste(s, 'anger.jpeg', sep='_'), p2, width = 10, height = 8, dpi = 300)
## sadness
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_sadness)] * 1.2
p3 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_sadness * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,75000), sec.axis = sec_axis(~./tmp_scale, name = "Sadness (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p3
ggsave(paste(s, 'sadness.jpeg', sep='_'), p3, width = 10, height = 8, dpi = 300)
## joy
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_joy)]  * 1.2
p4 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_joy * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,75000), sec.axis = sec_axis(~./tmp_scale, name = "Joy (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p4
ggsave(paste(s, 'joy.jpeg', sep='_'), p4, width = 10, height = 8, dpi = 300)
## disgust
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_disgust)]  * 1.2
p5 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_disgust * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,75000), sec.axis = sec_axis(~./tmp_scale, name = "Disgust (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p5
ggsave(paste(s, 'disgust.jpeg', sep='_'), p5, width = 10, height = 8, dpi = 300)
## fear
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_fear)]  * 1.2
p6 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_fear * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,75000), sec.axis = sec_axis(~./tmp_scale, name = "Fear (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p6
ggsave(paste(s, 'fear.jpeg', sep='_'), p6, width = 10, height = 8, dpi = 300)
## surprise
tmp_scale = dt[state==s, mean(new_cases)/mean(pred_surprise)]  * 1.2
p7 <- ggplot(dt[state == s,]) +
geom_col(aes(x = date, y = new_cases), size = 1, color = "lightblue", fill = "white") +
geom_line(aes(x = date, y = pred_surprise * tmp_scale), size = 1.5, color="darkblue", group = 1)+
scale_y_continuous(limits=c(0,75000), sec.axis = sec_axis(~./tmp_scale, name = "Surprise (positive rates among all tweets)"), name = 'New Confirmed Covid-19 Cases Daily') +
theme_bw() + scale_x_discrete(breaks =c('2020-03-01', '2020-04-01','2020-05-01', '2020-06-01','2020-07-01'))
p7
ggsave(paste(s, 'surprise.jpeg', sep='_'), p7, width = 10, height = 8, dpi = 300)
